<!-- templates/admin_components/users_management.html -->
<div class="container-fluid py-4">

  <!-- טופס הוספת משתמש -->
  <form id="addUserForm"
        class="row g-2 align-items-center justify-content-center">

    <!-- שם משרד -->
    <div class="col-auto form-floating fixed-input">
      <input id="officeName" name="office_name"
             class="form-control form-control-sm"
             placeholder="שם המשרד" required autocomplete="off">
      <label for="officeName">שם המשרד</label>
    </div>

    <!-- שם משתמש -->
    <div class="col-auto form-floating fixed-input">
      <input id="userName" name="username"
             class="form-control form-control-sm"
             placeholder="שם משתמש" required autocomplete="off">
      <label for="userName">שם משתמש</label>
    </div>

    <!-- סיסמה -->
    <div class="col-auto form-floating fixed-input">
      <input id="userPass" name="password" type="password"
             class="form-control form-control-sm"
             placeholder="סיסמה" required>
      <label for="userPass">סיסמה</label>
    </div>

    <!-- כפתור הוסף -->
    <div class="col-auto d-grid">
      <button class="btn btn-add btn-primary btn-sm small-btn">הוסף</button>
    </div>
  </form>

  <hr>

  <!-- טבלת משתמשים -->
  <table id="usersTable" class="text-center align-middle w-100">
    <thead>
      <tr>
        <th>שם המשרד</th>
        <th>שם משתמש</th>
        <th>נוצר</th>
        <th>איפוס סיסמה</th>
        <th>מחיקה</th>
      </tr>
    </thead>
    <tbody>
      {% for u in users %}
      <tr>
        <td>{{ u.office_name }}</td>
        <td>{{ u.username }}</td>
        <td>{{ u.created_at }}</td>

        <!-- איפוס/עדכון סיסמה -->
        <td>
          {% if u.username != 'admin' %}
          <form onsubmit="updateUser(event, '{{ u.username }}')" class="d-flex gap-2">
            <input type="password" name="password"
                   class="form-control form-control-sm"
                   placeholder="סיסמה חדשה" required>
            <button class="btn btn-primary btn-sm small-btn">עדכן</button>
          </form>
          {% else %} --- {% endif %}
        </td>

        <!-- מחיקה -->
        <td>
          {% if u.username != 'admin' %}
          <button class="btn btn-delete btn-sm small-btn"
                  onclick="deleteUser('{{ u.username }}')">🗑</button>
          {% else %} --- {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

</div>
